function suggestCompany(a, b) {
  var c = new Array();
  "" != a
    ? $.ajax({
        type: "POST",
        async: !1,
        url: ctx + "/c/companySearchCompanyLongs.json",
        data: { kd: a },
      }).done(function (d) {
        var e, f;
        if (d.success) {
          for (e = 0; e < d.content.length; e++)
            (f =
              '{"label":"' +
              d.content[e] +
              '","value":"' +
              d.content[e] +
              '"}'),
              (f = JSON.parse(f)),
              c.push(f);
          0 == c.length &&
            (c = [{ label: '' + a + '"', value: a }]),
            ($(b)
              .autocomplete({
                minLength: 0,
                source: c,
                delay: 500,
                focus: function () {
                  return !1;
                },
                select: function (a, c) {
                  return $(b).val(c.item.value), !1;
                },
              })
              .data("ui-autocomplete")._renderItem = function (a, b) {
              return $("<li>")
                .append("<a>" + b.label + "</a>")
                .appendTo(a);
            });
        }
      })
    : $(b).autocomplete({ source: c });
}
var timeout;
$(document).ready(function () {
  var a = $("#loadingDiv");
  $(document)
    .ajaxStart(function () {
      a.show();
    })
    .ajaxStop(function () {
      a.hide();
    }),
    $("#bindForm").validate({
      rules: {
        tel: { required: !0, isTel: !0, maxlength: 30 },
        email: { required: !0, email: !0, maxlength: 80 },
      },
      messages: {
        tel: {
          required: "",
          isTel:
            "",
          maxlength: "",
        },
        email: {
          required: "",
          email: "",
          maxlength: "",
        },
      },
      submitHandler: function (a) {
        var b, c, d;
        $(a).find(":submit").attr("disabled", !0),
          (b = $("#tel").val()),
          (c = $("#email").val()),
          (d = $("#resubmitToken").val()),
          $.ajax({
            type: "POST",
            data: { contact: b, receiveEmail: c, resubmitToken: d },
            url: ctx + "/corpCenter/saveContactAndEmail.json",
            dataType: "json",
          }).done(function (b) {
            $("#resubmitToken").val(b.resubmitToken),
              b.success
                ? (window.location.href = ctx + b.content)
                : ($("#beError").text(b.msg).show(),
                  $(a).find(":submit").attr("disabled", !1));
          });
      },
    }),
    $("#companyNameForm").validate({
      onkeyup: !1,
      focusCleanup: !0,
      rules: {
        companyName: {
          required: !0,
          specialchar: !0,
          checkNum: !0,
          maxlenStr: 100,
        },
      },
      messages: {
        companyName: {
          required: "",
          specialchar: "",
          checkNum: "",
          maxlenStr: "",
        },
      },
      submitHandler: function (a) {
        var b, c;
        $(a).find(":submit").attr("disabled", !0),
          (b = $("#companyName").val()),
          (c = $("#resubmitToken").val()),
          $.ajax({
            type: "POST",
            data: { companyName: b, resubmitToken: c },
            url: ctx + "/corpCenter/saveCompanyName.json",
            dataType: "json",
          }).done(function (b) {
            $("#resubmitToken").val(b.resubmitToken),
              b.success
                ? (window.location.href = ctx + b.content)
                : ($("#beError").text(b.msg).show(),
                  $(a).find(":submit").attr("disabled", !1));
          });
      },
    }),
    $(".open_service_result li a").bind("click", function () {
      var a = $(this).parent().attr("title"),
        b = $("#resubmitToken").val();
      $.ajax({
        type: "POST",
        url: ctx + "/corpCenter/saveCompanyName.json",
        data: { companyName: a, resubmitToken: b },
        dataType: "json",
      }).done(function (a) {
        $("#resubmitToken").val(a.resubmitToken),
          a.success ? (window.location.href = ctx + a.content) : alert(a.msg);
      });
    }),
    $("#resendOpenService").click(function () {
      $.ajax({
        type: "POST",
        data: {},
        url: ctx + "/corpCenter/resendBindEmail.json",
      }).done(function (a) {
        a.success
          ? $.colorbox({
              inline: !0,
              href: "#resend_success",
              title: "",
            })
          : alert(a.msg);
      });
    }),
    $("#companyName").keyup(function (a) {
      var d,
        b = a || window.event,
        c = b.keyCode;
      ((c > 64 && 91 > c) || 8 == c || 46 == c || 32 == c) &&
        ((d = $.trim($(this).val())),
        clearTimeout(timeout),
        (timeout = setTimeout(function () {
          suggestCompany(d, "#companyName");
        }, 200)));
    });
});
